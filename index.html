<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Book Library</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/128/3145/3145765.png">
</head>

<body class="bg-gradient-to-r from-fuchsia-500 to-pink-500">
    <div
        class="container w-[90vw] sm:w-[80vw] md:w-[70vw] lg:w-[60vw] xl:w-[40vw] bg-black rounded-lg shadow-lg text-white m-auto flex flex-col items-center justify-center p-4 mt-[5%] gap-4">
        <h1 class="heading text-xl sm:text-2xl md:text-3xl text-center animate-bounce max-w-[900px] min-w-[50px]">
            Simple Book Library
        </h1>
        <div class="formDetails max-w-[900px] w-full">
            <form action="" class="formGroup flex flex-col gap-4">
                <div class="bookTitle">
                    <label for="inputTitle">Book Title:</label><br>
                    <input type="text" name="" id="inputTitle"
                        class="px-4 py-2 rounded-lg shadow-lg border-[5px] border-red-400 w-full mt-[5px] text-orange-500"
                        placeholder="Enter Book Title">
                </div>
                <div class="bookAuthor">
                    <label for="inputTitle">Book Author:</label><br>
                    <input type="text" name="" id="inputAuthor"
                        class="px-4 py-2 rounded-lg shadow-lg border-[5px] border-red-400 w-full mt-[5px] text-orange-500"
                        placeholder="Enter Book Author">
                </div>
                <div class="bookYear">
                    <label for="inputTitle">Year:</label><br>
                    <input type="number" name="" id="inputYear"
                        class="px-4 py-2 rounded-lg shadow-lg border-[5px] border-red-400 w-full mt-[5px] text-orange-500"
                        placeholder="Enter Year">
                </div>
            </form>
        </div>

        <div>
            <button type="button"
                class="px-4 py-2 rounded-lg shadow-lg bg-[#414141] active:bg-[#2c2c2c] duration-300 mt-[2%] backdrop-blur-lg"
                id="addBookBtn">
                Add Books
            </button>
        </div>

        <div class="details mt-3 w-full overflow-x-auto">
            <table class="min-w-full border-collapse rounded-lg overflow-hidden shadow-lg">
                <thead class="bg-[#333] bg-opacity-80 backdrop-blur-lg text-white">
                    <tr>
                        <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base">Book</th>
                        <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base">Author</th>
                        <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base">Year</th>
                        <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base">Status</th>
                    </tr>
                </thead>
                <tbody class="bg-[#333] bg-opacity-80 backdrop-blur-lg text-white" id="tableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const addBookBtn = document.getElementById('addBookBtn')
            let allBooks = []
            let bookDetails = {}

            const storedBooks = localStorage.getItem('allBooks')
            if (storedBooks) {
                allBooks = JSON.parse(storedBooks)
            }

            const renderBooks = () => {
                const tbody = document.getElementById('tableBody')
                let rows = ''
                for (let i = 0; i < allBooks.length; i++) {
                    const singleBook = allBooks[i]
                    const titleClass = singleBook.isCompleted ? 'text-green-500' : 'text-white'
                    rows += `<tr data-index="${i}">
      <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base ${titleClass}">${singleBook.Title}</th>
      <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base ${titleClass}">${singleBook.Author}</th>
      <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base ${titleClass}">${singleBook.Year}</th>
      <th class="px-2 sm:px-4 md:px-6 py-3 text-center text-sm sm:text-base">
        <div class="buttons flex flex-row items-center gap-2 justify-center">
          <button type="button"
            class="complete bg-green-400 rounded-lg p-2 shadow-lg active:bg-green-700 duration-200 filter invert grayscale">
            <img src="https://cdn-icons-png.flaticon.com/128/9778/9778606.png" alt="Right" class="h-5">
          </button>
          <button type="button"
            class="delete bg-green-400 rounded-lg p-2 shadow-lg active:bg-red-700 duration-200 filter invert grayscale">
            <img src="https://cdn-icons-png.flaticon.com/128/484/484662.png" alt="bin" class="h-5">
          </button>
        </div>
      </th>
    </tr>`
                }
                tbody.innerHTML = rows


                localStorage.setItem('allBooks', JSON.stringify(allBooks))

                tbody.querySelectorAll('.delete').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const tr = e.target.closest('tr')
                        if (!tr) return
                        const index = parseInt(tr.dataset.index)
                        if (isNaN(index)) return

                        allBooks.splice(index, 1)
                        renderBooks()
                    })
                })

                tbody.querySelectorAll('.complete').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const tr = e.target.closest('tr')
                        if (!tr) {
                            return
                        }
                        const index = parseInt(tr.dataset.index)
                        if (isNaN(index)) {
                            return
                        }
                        allBooks[index].isCompleted = !allBooks[index].isCompleted
                        renderBooks()
                    })
                })
            }

            const addBooks = () => {
                const inputBookTitle = document.getElementById('inputTitle').value.trim()
                const inputAuthor = document.getElementById('inputAuthor').value.trim()
                const inputYear = document.getElementById('inputYear').value.trim()

                if (inputBookTitle === '' || inputAuthor === '' || inputYear === '') {
                    alert("The Fields Are Blank, Please Fill It")
                    return
                }
                bookDetails = {
                    Title: inputBookTitle,
                    Author: inputAuthor,
                    Year: inputYear,
                    isCompleted: false
                }
                allBooks.push(bookDetails)
                renderBooks()
            }
            addBookBtn.addEventListener("click", addBooks)
            renderBooks()
        })
    </script>
</body>

</html>